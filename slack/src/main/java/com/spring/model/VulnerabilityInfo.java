package com.spring.model;

import com.ws.api.model.LibraryInfo;

import java.util.Collection;
import java.util.HashSet;
import java.util.Objects;

public class VulnerabilityInfo {

    /* --- Static members --- */

    private static final String VULNERABILITY_DB_URL = "https://www.whitesourcesoftware.com/vulnerability-database/";

    /* --- Members --- */

    private String cve;
    private String severity;
    private String score;
    private String publishDate;
    private String wssUrl;
    private String description;
    private String fixVersion;
    private Collection<LibraryInfo> vulnerableLibraries;
    private Collection<Integer> projectIds;

    /* --- Constructors --- */

    public VulnerabilityInfo() {
        vulnerableLibraries = new HashSet<>();
        projectIds = new HashSet<>();
    }

    public VulnerabilityInfo(String cve, String severity, String score, String publishDate, String description, String fixVersion) {
        this();
        this.cve = cve;
        this.severity = severity;
        this.score = score;
        this.publishDate = publishDate;
        this.description = description;
        this.fixVersion = fixVersion;
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (o == null || getClass() != o.getClass()) return false;
        VulnerabilityInfo that = (VulnerabilityInfo) o;
        return Objects.equals(cve, that.cve);
    }

    @Override
    public int hashCode() {
        return Objects.hash(cve);
    }

    /* --- Public methods --- */

    public String getFullVulnerabilityUrl() {
        return VULNERABILITY_DB_URL + cve;
    }

    /* --- Getters / Setters --- */

    public String getCve() {
        return cve;
    }

    public void setCve(String cve) {
        this.cve = cve;
    }

    public String getSeverity() {
        return severity;
    }

    public void setSeverity(String severity) {
        this.severity = severity;
    }

    public String getScore() {
        return score;
    }

    public void setScore(String score) {
        this.score = score;
    }

    public String getPublishDate() {
        return publishDate;
    }

    public void setPublishDate(String publishDate) {
        this.publishDate = publishDate;
    }

    public String getWssUrl() {
        return wssUrl;
    }

    public void setWssUrl(String wssUrl) {
        this.wssUrl = wssUrl;
    }

    public String getDescription() {
        return description;
    }

    public void setDescription(String description) {
        this.description = description;
    }

    public String getFixVersion() {
        return fixVersion;
    }

    public void setFixVersion(String fixVersion) {
        this.fixVersion = fixVersion;
    }

    public Collection<LibraryInfo> getVulnerableLibraries() {
        return vulnerableLibraries;
    }

    public void setVulnerableLibraries(Collection<LibraryInfo> vulnerableLibraries) {
        this.vulnerableLibraries = vulnerableLibraries;
    }

    public Collection<Integer> getProjectIds() {
        return projectIds;
    }

    public void setProjectIds(Collection<Integer> projectIds) {
        this.projectIds = projectIds;
    }
}
